---
title: "Final Project"
author: "Jennifer Le"
date: "5/15/18"
output: html_document
---

```{r setupdb, include=FALSE}
library(ggplot2)
library(tidyr)
library(dplyr)
library(RColorBrewer)
```

#### Gathering and Tidying Data

Let's start by loading the data. 

```{r}
pokemon <- read.csv("/Users/jJ/Documents/CMSC320/Pokemon.csv")
pokemon %>%
  head(10)
```

The table already looks pretty tidy but there are still a few things we can fix to make it even better. Some of the column names are a bit confusing, so let's change them to more meaningful names. Also, we want to look at just the first three generations of Pokemon, so let's filter that out. 

```{r}
pokemon <- pokemon %>%
  rename(ID = X., Type1 = Type.1, Type2 = Type.2, SpecialAttack = Sp..Atk, SpecialDefense = Sp..Def) %>%
  filter(Generation <= 3)
pokemon
```

Let's create some new attributes. The first one will be named Average and it calculate the total average of all statistics (HP, attack, defense, special attack, special defense, speed) for each Pokemon. This statistical average will show how high a Pokemon's statistics are and how strong it is. The second attribute called DoubleType will show if a Pokemon has two types or not. Some Pokemon only have one type but others have two types. This can come as an advantage for the Pokemon as they will 


```{r}
pokemon <- pokemon %>%
  mutate(AverageStats = Total / 6) %>%
  mutate(DoubleType = ifelse(Type2 != "", TRUE, FALSE))
pokemon
```


```{r}
gen1 <- pokemon %>%
  filter(Generation == 1)
gen1
```

```{r}
gen2 <- pokemon %>%
  filter(Generation == 2)
gen2
```

```{r}
gen3 <- pokemon %>%
  filter(Generation == 3)
gen3
```


#### Exploratory Data Analysis

```{r}
avgStats <- pokemon %>%
  group_by(Type1) %>%
  summarize(avgHP = mean(HP), avgAttack = mean(Attack), avgDefense = mean(Defense), avgSpAttack = mean(SpecialAttack), avgSpDefense = mean(SpecialDefense), avgSpeed = mean(Speed))

avgStats
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgHP)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average HP", title="Average HP of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgAttack)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average Attack", title="Average Attack of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgDefense)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average Defense", title="Average Defense of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=avgAttack, y=avgDefense)) + geom_point(aes(color=Type1)) + geom_text(aes(label=Type1)) + labs(x="Average Attack", y="Average Defense", title="Average Attack vs. Average Defense of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
gen1 %>%
  filter(Type1 == "Water") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Water Pokemon in Gen 1") + theme(axis.text.x=element_text(angle=90, hjust=1))

gen2 %>%
  filter(Type1 == "Water") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Water Pokemon in Gen 2") + theme(axis.text.x=element_text(angle=90, hjust=1))

gen3 %>%
  filter(Type1 == "Water") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Water Pokemon in Gen 3") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


