

```{r setupdb, include=FALSE}
library(ggplot2)
library(tidyr)
library(dplyr)
```

### Pok√©mon Statistics

##### Jennifer Le


#### Introduction

Pokemon is a media franchise that surrounds creatures called Pokemon, which Pokemon trainers catch and train in order to battle each other. Pokemon started out as video games, but have grown to include trading cards, animated television shows and movies, comic books, and toys. This tutorial is going to focus on the video games and the Pokemon's statistics in these games. Every Pokemon has a type (some have two) along with statistics such as HP, attack, defense, special attack, special defense, and speed. There are also a few Pokemon that are "legendary." These Pokemon are considered the best and most powerful Pokemon that you battle at the end of the game. 

#### Required Tools

You will need to download R and the following packages:

- dplyr
- tidyr
- ggplot2

R can be downloaded here: https://cran.r-project.org/index.html

#### Getting started

Let's start by loading the data. The dataset can be found at https://www.kaggle.com/alberthkcheng/pokemon/data. This dataset includes all Pokemon and their statistics from generations 1-6. 

```{r}
pokemon <- read.csv("/Users/jJ/Documents/CMSC320/Pokemon.csv")
pokemon %>%
  head(10)
```

From the table, we can see the Pokemon's ID, name, type(s), battle statistics, generation, and whether or not it's legendary. The table already looks pretty tidy but there are still a few things we can fix to make it even better. Some of the column names are a bit confusing, so let's change them to make them more easier to understand. Also, we want to look at just the first three generations of Pokemon, so let's filter those Pokemon out. 

```{r}
pokemon <- pokemon %>%
  rename(ID = X., Type1 = Type.1, Type2 = Type.2, SpecialAttack = Sp..Atk, SpecialDefense = Sp..Def) %>%
  filter(Generation <= 3)
head(pokemon)
```

Let's create some new attributes that will help us understand the data a little better. The first one will be named AverageStats and it will calculate the total average of all statistics (HP, attack, defense, special attack, special defense, speed) for each Pokemon. This statistical average will show how high a Pokemon's statistics are and how strong it is. The second attribute called DoubleType will show if a Pokemon has two types by displaying either TRUE or FALSE. Some Pokemon only have one type but others have two types. This can come as an advantage for the Pokemon as they are able to cause damage to more types of Pokemon as opposed to those with only one type. However, this also means that the Pokemon with two types are weak against more types of Pokemon. 

```{r}
pokemon <- pokemon %>%
  mutate(AverageStats = Total / 6) %>%
  mutate(DoubleType = ifelse(Type2 != "", TRUE, FALSE))
head(pokemon)
```

Let's create some tables for each of the first three generations. This will make it easier to grab data from each generation.

```{r}
gen1 <- pokemon %>%
  filter(Generation == 1)
head(gen1)

gen2 <- pokemon %>%
  filter(Generation == 2)
head(gen2)

gen3 <- pokemon %>%
  filter(Generation == 3)
head(gen3)
```

Let's also create a table just for legendary Pokemon. 

```{r}
legendary <- pokemon %>%
  filter(Legendary == "True")
head(legendary)
```

#### Exploratory Data Analysis

```{r}
avgStats <- pokemon %>%
  group_by(Type1) %>%
  summarize(avgHP = mean(HP), avgAttack = mean(Attack), avgDefense = mean(Defense), avgSpAttack = mean(SpecialAttack), avgSpDefense = mean(SpecialDefense), avgSpeed = mean(Speed))

head(avgStats)
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgHP)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average HP", title="Average HP of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgAttack)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average Attack", title="Average Attack of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgDefense)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average Defense", title="Average Defense of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgSpAttack)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average Special Attack", title="Average Special Attack of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgSpDefense)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average Special Defense", title="Average Special Defense of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```


```{r}
avgStats %>%
  ggplot(mapping=aes(x=Type1, y=avgSpeed)) + geom_bar(aes(fill=Type1), position="dodge", stat="identity") +  labs(x="Type", y="Average Speed", title="Average Speed of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```



```{r}
avgStats %>%
  ggplot(mapping=aes(x=avgAttack, y=avgDefense)) + geom_point(aes(color=Type1)) + geom_text(aes(label=Type1)) + labs(x="Average Attack", y="Average Defense", title="Average Attack vs. Average Defense of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```

```{r}
avgStats %>%
  ggplot(mapping=aes(x=avgSpAttack, y=avgSpDefense)) + geom_point(aes(color=Type1)) + geom_text(aes(label=Type1)) + labs(x="Average Special Attack", y="Average Special Defense", title="Average Special Attack vs. Average Special Defense of Each Pokemon Type") + theme(axis.text.x=element_text(angle=90, hjust=1))
```

```{r}
gen1Water <- gen1 %>%
  filter(Type1 == "Water") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Water Pokemon in Gen 1") + theme(axis.text.x=element_text(angle=90, hjust=1))
gen1Water

gen2Water <- gen2 %>%
  filter(Type1 == "Water") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Water Pokemon in Gen 2") + theme(axis.text.x=element_text(angle=90, hjust=1))
gen2Water

gen3Water <- gen3 %>%
  filter(Type1 == "Water") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Water Pokemon in Gen 3") + theme(axis.text.x=element_text(angle=90, hjust=1))
gen3Water
```

```{r}
gen1Fire <- gen1 %>%
  filter(Type1 == "Fire") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Fire Pokemon in Gen 1") + theme(axis.text.x=element_text(angle=90, hjust=1))
gen1Fire

gen2Fire <- gen2 %>%
  filter(Type1 == "Fire") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Fire Pokemon in Gen 2") + theme(axis.text.x=element_text(angle=90, hjust=1))
gen2Fire

gen3Fire <- gen3 %>%
  filter(Type1 == "Fire") %>%
  ggplot(mapping=aes(x=Name, y=AverageStats)) + geom_bar(position="dodge", stat="identity") + labs(x="Pokemon Name", y="Average Stats", title="Average Stats of Each Fire Pokemon in Gen 3") + theme(axis.text.x=element_text(angle=90, hjust=1))
gen3Fire
```

### MAKE TABLE OF THE HIGHEST OVERALL STATS
```{r}
highestOverall <- pokemon %>%
  arrange(desc(Total))

head(highestOverall)
```


### MAKE TABLE OF THE HIGHEST OVERALL STATS FOR EACH TYPE
```{r}
overallByType <- pokemon %>%
  group_by(Type1) %>%
  summarize(Top = max(Total))

overallByType
```

### COMPARE THE NUMBER OF SINGLE TYPE VS DOUBLE TYPE POKEMON FROM GEN1
```{r}
typeGen1 <- gen1 %>%
  group_by(DoubleType) %>%
  summarize(Number = n()) %>%
  mutate(Generation = "Gen1")

typeGen1
```


### COMPARE THE NUMBER OF SINGLE TYPE VS DOUBLE TYPE POKEMON FROM GEN2
```{r}
typeGen2 <- gen2 %>%
  group_by(DoubleType) %>%
  summarize(Number = n()) %>%
  mutate(Generation = "Gen2")

typeGen2
```


### COMPARE THE NUMBER OF SINGLE TYPE VS DOUBLE TYPE POKEMON FROM GEN3
```{r}
typeGen3 <- gen3 %>%
  group_by(DoubleType) %>%
  summarize(Number = n()) %>%
  mutate(Generation = "Gen3")

typeGen3
```

### COMBINE THE DOUBLETYPE TABLES INTO ONE TABLE
```{r}
types <- rbind(typeGen1, typeGen2, typeGen3)
types
```


### GET ALL LEGENDARY POKEMON AND PLOT THEIR ATTACK VS SPECIAL ATTACK
```{r}
legendary
```


### GET ALL LEGENDARY POKEMON AND PLOT THEIR DEFENSE VS SPECIAL DEFENSE
```{r}
legendary
```


### CONCLUSIONS
